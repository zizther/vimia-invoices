var ne=Object.defineProperty;var L=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var M=(_,m,o)=>m in _?ne(_,m,{enumerable:!0,configurable:!0,writable:!0,value:o}):_[m]=o,z=(_,m)=>{for(var o in m||(m={}))re.call(m,o)&&M(_,o,m[o]);if(L)for(var o of L(m))le.call(m,o)&&M(_,o,m[o]);return _};import{J as ie,ah as de,B as f,G as ce,aN as ue,a0 as me,k as x,C as fe,A as ve,r as c,o as d,e as I,f as a,l as v,w as r,h as u,u as s,i as w,t as b,j as p,F as P,y as pe,m as _e}from"./vendor.01d0adc5.js";import{_ as ye}from"./InvoiceIndexDropdown.59958dc4.js";import{c as be,i as ge,u as he,e as Be,j as xe,g as F}from"./main.c43fbacd.js";import{_ as Ie}from"./SendInvoiceModal.5a733015.js";import{L as ke}from"./LoadingIcon.8e3c4639.js";import"./mail-driver.299d5771.js";const Ee={class:"text-sm mr-3"},Se={class:"fixed top-0 left-0 hidden h-full pt-16 pb-4 ml-56 bg-white xl:ml-64 w-88 xl:block"},we={class:"flex items-center justify-between px-4 pt-8 pb-2 border border-gray-200 border-solid height-full"},Te={class:"mb-6"},De={class:"flex mb-6 ml-3",role:"group","aria-label":"First group"},Ve={class:"px-2 py-1 pb-2 mb-1 mb-2 text-sm border-b border-gray-200 border-solid"},$e={key:0,class:"h-full pb-32 overflow-y-scroll border-l border-gray-200 border-solid base-scroll"},Fe={class:"flex-2"},Ne={class:"mt-1 mb-2 text-xs not-italic font-medium leading-5 text-gray-600"},Ae={class:"flex-1 whitespace-nowrap right"},Ce={class:"text-sm not-italic font-normal leading-5 text-right text-gray-600 est-date"},je={class:"flex justify-center p-4 items-center"},Re={key:0,class:"flex justify-center px-4 mt-5 text-sm text-gray-600"},Le={class:"flex flex-col min-h-0 mt-8 overflow-hidden",style:{height:"75vh"}},Me=["src"],We={setup(_){const m=be(),o=ge();he();const T=Be(),U=xe(),{t:g}=ie();de("$utils"),f(null),f(null);const l=f(null);f(null);const k=ce();ue(),f(["DRAFT","SENT","VIEWED","EXPIRED","ACCEPTED","REJECTED"]);const E=f(!1),O=f(!1);f(!1);const N=f(!1),h=f(!1),t=me({orderBy:null,orderByField:null,searchText:null}),G=x(()=>l.value.invoice_number),A=x(()=>t.orderBy==="asc"||t.orderBy==null);x(()=>A.value?g("general.ascending"):g("general.descending"));const H=x(()=>`/invoices/pdf/${l.value.unique_hash}`);x(()=>l.value&&l.value.id?invoice.value.id:null),fe(k,(e,i)=>{e.name==="invoices.view"&&j()});async function J(){U.openDialog({title:g("general.are_you_sure"),message:g("invoices.invoice_mark_as_sent"),yesLabel:g("general.ok"),noLabel:g("general.cancel"),variant:"primary",hideNoButton:!1,size:"lg"}).then(async e=>{E.value=!1,e&&(await o.markAsSent({id:l.value.id,status:"SENT"}),l.value.status="SENT",E.value=!0),E.value=!1})}async function W(e){m.openModal({title:g("invoices.send_invoice"),componentName:"SendInvoiceModal",id:l.value.id,data:l.value})}function q(e){return k.params.id==e}async function C(){h.value=!0,await o.fetchInvoices(),h.value=!1,setTimeout(()=>{X()},500)}function X(){const e=document.getElementById(`invoice-${k.params.id}`);e&&(e.scrollIntoView({behavior:"smooth"}),e.classList.add("shake"))}async function j(){let e=await o.fetchInvoice(k.params.id);e.data&&(l.value=z({},e.data.data))}async function y(){let e="";t.searchText!==""&&t.searchText!==null&&t.searchText!==void 0&&(e+=`search=${t.searchText}&`),t.orderBy!==null&&t.orderBy!==void 0&&(e+=`orderBy=${t.orderBy}&`),t.orderByField!==null&&t.orderByField!==void 0&&(e+=`orderByField=${t.orderByField}`),N.value=!0;let i=await o.searchInvoice(e);N.value=!1,i.data&&(o.invoices=i.data.data)}function Y(){return t.orderBy==="asc"?(t.orderBy="desc",y(),!0):(t.orderBy="asc",y(),!0)}return C(),j(),y=ve.exports.debounce(y,500),(e,i)=>{const B=c("BaseButton"),R=c("router-link"),K=c("BasePageHeader"),S=c("BaseIcon"),Q=c("BaseInput"),D=c("BaseRadio"),V=c("BaseInputGroup"),$=c("BaseDropdownItem"),Z=c("BaseDropdown"),ee=c("BaseText"),te=c("BaseEstimateStatusBadge"),ae=c("BaseFormatMoney"),se=c("BasePage");return d(),I(P,null,[a(Ie),l.value?(d(),v(se,{key:0,class:"xl:pl-96 xl:ml-8"},{default:r(()=>[a(K,{title:s(G)},{actions:r(()=>[u("div",Ee,[l.value.status==="DRAFT"&&s(T).hasAbilities(s(F).EDIT_INVOICE)?(d(),v(B,{key:0,disabled:E.value,variant:"primary-outline",onClick:J},{default:r(()=>[w(b(e.$t("invoices.mark_as_sent")),1)]),_:1},8,["disabled"])):p("",!0)]),l.value.status==="DRAFT"&&s(T).hasAbilities(s(F).SEND_INVOICE)?(d(),v(B,{key:0,disabled:O.value,variant:"primary",class:"text-sm",onClick:W},{default:r(()=>[w(b(e.$t("invoices.send_invoice")),1)]),_:1},8,["disabled"])):p("",!0),s(T).hasAbilities(s(F).CREATE_PAYMENT)?(d(),v(R,{key:1,to:`/admin/payments/${e.$route.params.id}/create`},{default:r(()=>[l.value.status==="SENT"||l.value.status==="OVERDUE"||l.value.status==="VIEWED"?(d(),v(B,{key:0,variant:"primary"},{default:r(()=>[w(b(e.$t("invoices.record_payment")),1)]),_:1})):p("",!0)]),_:1},8,["to"])):p("",!0),a(ye,{class:"ml-3",row:l.value,"load-data":C},null,8,["row"])]),_:1},8,["title"]),u("div",Se,[u("div",we,[u("div",Te,[a(Q,{modelValue:s(t).searchText,"onUpdate:modelValue":i[0]||(i[0]=n=>s(t).searchText=n),placeholder:e.$t("general.search"),type:"text",variant:"gray",onInput:i[1]||(i[1]=n=>y())},{right:r(()=>[a(S,{name:"SearchIcon",class:"h-5 text-gray-400"})]),_:1},8,["modelValue","placeholder"])]),u("div",De,[a(Z,{class:"ml-3",position:"bottom-start"},{activator:r(()=>[a(B,{size:"md",variant:"gray"},{default:r(()=>[a(S,{name:"FilterIcon"})]),_:1})]),default:r(()=>[u("div",Ve,b(e.$t("general.sort_by")),1),a($,{class:"flex px-1 py-2 cursor-pointer"},{default:r(()=>[a(V,{class:"-mt-3 font-normal"},{default:r(()=>[a(D,{id:"filter_invoice_date",modelValue:s(t).orderByField,"onUpdate:modelValue":[i[2]||(i[2]=n=>s(t).orderByField=n),y],label:e.$t("reports.invoices.invoice_date"),size:"sm",name:"filter",value:"invoice_date"},null,8,["modelValue","label"])]),_:1})]),_:1}),a($,{class:"flex px-1 py-2 cursor-pointer"},{default:r(()=>[a(V,{class:"-mt-3 font-normal"},{default:r(()=>[a(D,{id:"filter_due_date",modelValue:s(t).orderByField,"onUpdate:modelValue":[i[3]||(i[3]=n=>s(t).orderByField=n),y],label:e.$t("invoices.due_date"),value:"due_date",size:"sm",name:"filter"},null,8,["modelValue","label"])]),_:1})]),_:1}),a($,{class:"flex px-1 py-2 cursor-pointer"},{default:r(()=>[a(V,{class:"-mt-3 font-normal"},{default:r(()=>[a(D,{id:"filter_invoice_number",modelValue:s(t).orderByField,"onUpdate:modelValue":[i[4]||(i[4]=n=>s(t).orderByField=n),y],label:e.$t("invoices.invoice_number"),value:"invoice_number",size:"sm",name:"filter"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),a(B,{class:"ml-1",size:"md",variant:"gray",onClick:Y},{default:r(()=>[s(A)?(d(),v(S,{key:0,name:"SortAscendingIcon"})):(d(),v(S,{key:1,name:"SortDescendingIcon"}))]),_:1})])]),s(o)&&s(o).invoices?(d(),I("div",$e,[(d(!0),I(P,null,pe(s(o).invoices,(n,oe)=>(d(),I("div",{key:oe},[n&&!h.value?(d(),v(R,{key:0,id:"invoice-"+n.id,to:`/admin/invoices/${n.id}/view`,class:_e(["flex justify-between side-invoice p-4 cursor-pointer hover:bg-gray-100 items-center border-l-4 border-transparent",{"bg-gray-100 border-l-4 border-primary-500 border-solid":q(n.id)}]),style:{"border-bottom":"1px solid rgba(185, 193, 209, 0.41)"}},{default:r(()=>[u("div",Fe,[a(ee,{text:n.customer.name,length:30,class:"pr-2 mb-2 text-sm not-italic font-normal leading-5 text-black capitalize truncate"},null,8,["text"]),u("div",Ne,b(n.invoice_number),1),a(te,{status:n.status,class:"px-1 text-xs"},{default:r(()=>[w(b(n.status),1)]),_:2},1032,["status"])]),u("div",Ae,[a(ae,{class:"mb-2 text-xl not-italic font-semibold leading-8 text-right text-gray-900 block",amount:n.total,currency:n.customer.currency},null,8,["amount","currency"]),u("div",Ce,b(n.formatted_invoice_date),1)])]),_:2},1032,["id","to","class"])):p("",!0)]))),128)),u("div",je,[h.value?(d(),v(ke,{key:0,class:"h-6 m-1 animate-spin text-primary-400"})):p("",!0)]),!s(o).invoices.length&&!h.value?(d(),I("p",Re,b(e.$t("invoices.no_matching_invoices")),1)):p("",!0)])):p("",!0)]),u("div",Le,[u("iframe",{src:`${s(H)}`,class:"flex-1 border border-gray-400 border-solid bg-white rounded-md frame-style"},null,8,Me)])]),_:1})):p("",!0)],64)}}};export{We as default};
